FROM node:16.13.0-alpine
WORKDIR /app
COPY . .

ARG REACT_APP_GOOGLE_CLIENT_ID REACT_APP_SERV_URL SERV_ENABLE_SSL
ENV REACT_APP_GOOGLE_CLIENT_ID $REACT_APP_GOOGLE_CLIENT_ID
ENV REACT_APP_SERV_URL $REACT_APP_SERV_URL
ENV SERV_ENABLE_SSL $SERV_ENABLE_SSL

RUN npm install
RUN npm install -g serve
RUN npm run build

EXPOSE 3000
CMD ["sh", "-c", "./run.sh"]